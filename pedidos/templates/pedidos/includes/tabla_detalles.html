<div class="card bg-dark text-white mb-3">
    <div class="card-body p-3">
        <div class="row">
            <div class="col-md-6">
                <h6 class="card-subtitle mb-2 text-muted">Información del Cliente</h6>
                <p class="mb-1"><strong>Nombre:</strong> {{ pedido.cliente.get_full_name }}</p>
                <p class="mb-1"><strong>CI:</strong> {{ pedido.cliente.carnet_identidad }}</p>
                <p class="mb-1"><strong>Teléfono:</strong> {{ pedido.cliente.telefono }}</p>
            </div>
            <div class="col-md-6">
                <h6 class="card-subtitle mb-2 text-muted">Información de Envío</h6>
                <p class="mb-1"><strong>Transportista:</strong> {{ pedido.transportista|default:"No especificado" }}</p>
                <p class="mb-1"><strong>Fecha del pedido:</strong> {{ pedido.created_at|date:"d/m/Y H:i" }}</p>
                <p class="mb-1"><strong>Estado:</strong> 
                    <span class="badge {% if pedido.estado == 'efectuado' %}bg-success{% elif pedido.estado == 'pendiente' %}bg-warning{% elif pedido.estado == 'cancelado' %}bg-danger{% else %}bg-info{% endif %}">
                        {{ pedido.estado|title }}
                    </span>
                </p>
            </div>
        </div>
    </div>
</div>

<div class="table-responsive">
    <table class="table table-dark table-hover table-sm">
        <thead>
            <tr>
                <th style="width: 35%;">Artículo</th>
                <th class="text-center d-none d-sm-table-cell" style="width: 15%;">Código</th>
                <th class="text-center" style="width: 10%;">Cant.</th>
                <th class="text-center" style="width: 20%;">Precio</th>
                <th class="text-center" style="width: 20%;">Total</th>
            </tr>
        </thead>
        <tbody>
            {% for detalle in pedido.pedidodetalle_set.all %}
            <tr>
                <td>
                    <div>{{ detalle.material.nombre }}</div>
                    <small class="d-sm-none text-muted">Código:{{ detalle.material.codigo|default:"Sin código" }}</small>
                    {% if detalle.en_oferta %}
                        <span class="badge bg-danger small">Oferta</span>
                    {% endif %}
                </td>
                <td class="text-center d-none d-sm-table-cell">{{ detalle.material.codigo|default:"Sin código" }}</td>
                <td class="text-center">{{ detalle.cantidad }}</td>
                <td class="text-center">
                    <div>${{ detalle.precio_unitario|default:detalle.material.precio|floatformat:2 }}</div>
                    {% if detalle.en_oferta %}
                        <small class="text-muted text-decoration-line-through">${{ detalle.precio_regular|floatformat:2 }}</small>
                        <small class="text-danger">-{{ detalle.descuento_aplicado|floatformat:0 }}%</small>
                    {% endif %}
                </td>
                <td class="text-center">${{ detalle.total|floatformat:2 }}</td>
            </tr>
            {% endfor %}
            <tr class="table-active">
                <td colspan="2" class="d-none d-sm-table-cell"></td>
                <td colspan="2" class="d-table-cell d-sm-none"></td>
                <td class="text-center"><strong>Total:</strong></td>
                <td class="text-center"><strong>${{ pedido.total|floatformat:2 }}</strong></td>
            </tr>
        </tbody>
    </table>
</div>

<style>
@media (max-width: 767px) {
    .table {
        font-size: 0.85rem;
    }
    
    .table td, .table th {
        padding: 0.4rem;
        vertical-align: middle;
    }

    .table .badge {
        font-size: 0.7rem;
        padding: 0.2em 0.4em;
    }

    .table small {
        font-size: 0.75rem;
        display: block;
        line-height: 1.2;
    }
}

@media (min-width: 768px) {
    .table td, .table th {
        padding: 0.5rem;
    }
    
    .table-sm td, .table-sm th {
        padding: 0.3rem;
    }
}
</style>